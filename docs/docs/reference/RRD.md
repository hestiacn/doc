# RRD（Round Robin Database）介绍及其在Hestia中的应用

## 一、RRD（Round Robin Database）概述

RRD（Round Robin Database）是一种高效的时间序列数据库，特别适用于存储和管理大量的时间序列数据。其核心设计理念是使用固定大小的数据库文件，通过循环覆盖旧数据的方式，保持数据库的高效性和稳定性。RRD数据库在处理大量时间序列数据时，能够避免数据无限增长带来的性能问题，同时提供了快速的数据查询和访问能力。

## 二、RRD的主要特点

1. **固定大小**：RRD数据库在创建时即确定了其大小，不会因为数据的增加而无限扩张，从而有效管理存储空间。
2. **循环存储**：当数据库写满时，新数据会自动覆盖最旧的数据，实现数据的循环存储，确保数据的实时性。
3. **高效性**：RRD数据库的设计简单且高效，避免了复杂的索引和数据结构，使得数据的存储和查询操作都非常迅速。
4. **时间序列数据支持**：RRD特别适用于存储时间序列数据，能够记录数据随时间的变化情况，为系统监控和性能分析提供有力支持。

## 三、RRD在Hestia中的应用

Hestia作为一个功能强大的控制面板，充分利用了RRD数据库的优势，为系统管理员提供了全面的监控和性能分析功能。通过集成RRD数据库，Hestia能够实时收集系统的各种性能指标，如CPU使用率、内存占用率、网络流量等，并将这些数据存储在RRD数据库中。

管理员可以通过Hestia轻松查看这些指标的历史数据，了解系统的运行状况。此外，Hestia还提供了丰富的可视化工具，将RRD数据库中的数据以图形化的方式展示，使得管理员能够更直观地了解系统的性能变化趋势，及时发现并解决问题。

通过使用RRD数据库，Hestia实现了对系统性能的高效监控和分析，为管理员提供了有力的支持，帮助他们更好地管理和维护系统。

### 四、总结

RRD（Round Robin Database）作为一种高效的时间序列数据库，在Hestia控制面板中发挥着重要作用。通过利用RRD数据库的优势，Hestia为管理员提供了全面的系统监控和性能分析功能，帮助他们更好地了解系统的运行状况，实现有效的系统管理。

在实际应用中，管理员可以根据需要配置和调整RRD数据库的参数，以适应不同的监控需求。同时，随着技术的不断发展，RRD数据库和Hestia控制面板也将不断优化和升级，为系统管理员提供更加高效、便捷的管理体验。

## v-update-sys-rrd

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd)

`v-update-sys-rrd` 是 Hestia 控制面板的一个 CLI 命令脚本，用于更新系统 RRD（Round Robin Database）文件。RRD 是一种时间序列数据存储系统，特别适合存储系统性能、网络流量等随时间变化的数据。该脚本通过更新不同时间周期（如每日、每周、每月和每年）的 RRD 文件，帮助管理员监控和分析系统性能数据。

### 基本用法

```bash
v-update-sys-rrd
```

此脚本不需要任何参数，它会自动检查并更新所有相关的 RRD 文件。

### 脚本执行流程

1. **加载配置与函数**：脚本首先加载 Hestia 的配置文件和必要的函数。

2. **创建 RRD 目录**：如果 RRD 目录不存在，脚本会创建它。

3. **检查并更新 RRD 文件**：
   - 脚本检查每日、每周、每月和每年的 RRD 文件是否存在，并计算自上次修改以来的时间差。
   - 如果时间差超过预设的阈值（例如，每日文件超过 5 分钟未更新），则使用 `touch` 命令更新文件的修改时间，并将对应的时间周期添加到 `periods` 变量中。
   - 如果文件不存在，则创建它并同样添加到 `periods` 变量中。

4. **执行 RRD 更新**：对于 `periods` 变量中的每个时间周期，脚本调用一系列相关的更新命令来更新对应的 RRD 文件。这些命令包括更新系统负载、网络流量、内存使用情况、SSH 会话数等。

5. **处理特定服务**：如果配置了 Web、代理、邮件或 FTP 服务，脚本会调用相应的更新命令来更新这些服务的 RRD 文件。

6. **输出处理**：所有命令的输出都被重定向到 `/dev/null`，以避免在终端显示任何输出信息。

### 示例

#### 示例 1：基本使用

```bash
v-update-sys-rrd
```

此命令将执行脚本的默认行为，即检查并更新所有相关的 RRD 文件。

### 注意事项

- 确保在运行此脚本之前，已经正确配置了 Hestia 控制面板，并且 RRD 目录具有适当的权限。
- 根据系统的负载和性能需求，管理员可能需要调整 RRD 文件的更新频率和阈值。
- 该脚本可能需要一些时间来执行，特别是当需要更新多个 RRD 文件时。请确保在执行此脚本时，系统具有足够的资源可用。

### 总结

## v-update-sys-rrd-apache2

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-apache2)

`v-update-sys-rrd` 脚本是 Hestia 控制面板中一个重要的工具，用于更新和管理系统性能数据的 RRD 文件。通过正确配置和使用此脚本，管理员可以轻松地监控和分析系统的性能数据，以便更好地了解系统的运行状况并进行相应的优化。在使用此脚本时，请遵循最佳实践，并根据需要进行适当的调整和监控。

`v-update-sys-rrd-apache2` 是 Hestia 控制面板的一个 CLI 命令脚本，用于更新 Apache2 服务相关的 RRD（Round Robin Database）文件。这个脚本能够收集 Apache2 的性能数据，并将其存储在 RRD 文件中，以便于后续的监控和分析。

### 基本用法

```bash
v-update-sys-rrd-apache2 [period]
```

其中 `[period]` 是一个可选参数，用于指定更新的时间周期。支持的时间周期包括 `daily`（每日）、`weekly`（每周）、`monthly`（每月）和 `yearly`（每年）。如果没有指定时间周期，则默认为 `daily`。

### 脚本执行流程

1. **参数解析与配置加载**：脚本首先解析传入的周期参数，并加载 Hestia 的配置文件和相关函数。

2. **RRD 文件创建与检查**：如果 FTP 相关的 RRD 目录不存在，脚本会创建它。接着，检查 FTP 的 RRD 文件是否存在，如果不存在则创建新的 RRD 文件，并定义数据源（DS）和归档规则（RRA）。

3. **数据收集**：根据指定的时间周期，脚本通过执行 `ps aux` 命令来收集当前 Apache2 服务的进程数量，这可以作为连接数的近似值。

4. **更新 RRD 文件**：将收集到的数据更新到 RRD 文件中。

5. **生成图形报告**：使用 `rrdtool graph` 命令生成一个 PNG 图像文件，展示 Apache2 服务的连接数随时间的变化趋势。图像的格式、大小、颜色等都可以通过脚本中的参数进行配置。

6. **错误处理**：如果在生成图形报告的过程中发生错误，脚本会记录错误并退出，返回特定的错误代码。

### 示例

#### 示例 1：每日更新 Apache2 的 RRD 文件并生成图形报告

```bash
v-update-sys-rrd-apache2 daily
```

此命令将收集 Apache2 服务的每日连接数数据，并更新到对应的 RRD 文件中。同时，它还会生成一个名为 `daily-ftp.png` 的 PNG 图像文件，展示每日的连接数变化趋势。

#### 示例 2：每周更新 Apache2 的 RRD 文件并生成图形报告

```bash
v-update-sys-rrd-apache2 weekly
```

与示例 1 类似，此命令将收集 Apache2 服务的每周连接数数据，并更新到 RRD 文件中。生成的图形报告将展示每周的连接数变化趋势。

### 注意事项

- 在运行此脚本之前，请确保已经正确配置了 Hestia 控制面板，并且 Apache2 服务正在运行。
- 根据系统的负载和性能需求，管理员可能需要调整 RRD 文件的更新频率和阈值。
- 该脚本可能需要一些时间来执行，特别是当需要生成图形报告时。请确保在执行此脚本时，系统具有足够的资源可用。

### 总结

`v-update-sys-rrd-apache2` 脚本是 Hestia 控制面板中用于监控和分析 Apache2 服务性能的重要工具。通过定期更新 RRD 文件并生成图形报告，管理员可以轻松地了解 Apache2 服务的连接数变化趋势，以便及时发现问题并进行优化。在使用此脚本时，请遵循最佳实践，并根据需要进行适当的调整和监控。

## v-update-sys-rrd-ftp

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-ftp)

`v-update-sys-rrd-ftp` 是 Hestia 控制面板的一个 CLI 命令脚本，用于更新 FTP 服务的 RRD（Round Robin Database）文件。这个脚本能够收集 FTP 服务的性能数据，并将其存储在 RRD 文件中，以便于后续的监控和分析。

### 基本用法

```bash
v-update-sys-rrd-ftp [period]
```

其中 `[period]` 是一个可选参数，用于指定更新的时间周期。支持的时间周期包括 `daily`（每日）、`weekly`（每周）、`monthly`（每月）和 `yearly`（每年）。如果没有指定时间周期，则默认为 `daily`。

### 脚本执行流程

1. **参数解析与配置加载**：脚本首先解析传入的周期参数，并加载 Hestia 的配置文件和相关函数。

2. **RRD 文件创建与检查**：脚本检查 FTP 相关的 RRD 目录是否存在，如果不存在则创建。接着，检查 FTP 的 RRD 文件是否存在，如果不存在则根据预设的规则创建新的 RRD 文件。

3. **数据收集**：根据指定的时间周期，脚本通过执行 `ps aux` 命令来收集当前 FTP 服务的进程数量，这可以作为连接数的近似值。

4. **更新 RRD 文件**：将收集到的数据更新到 RRD 文件中。

5. **生成图形报告**：使用 `rrdtool graph` 命令生成一个 PNG 图像文件，展示 FTP 服务的连接数随时间的变化趋势。图像的格式、大小、颜色等都可以通过脚本中的参数进行配置。

6. **错误处理**：如果在生成图形报告的过程中发生错误，脚本会记录错误并退出，返回特定的错误代码。

7. **退出**：脚本执行完毕后退出。

### 示例

#### 示例 1：每日更新 FTP 的 RRD 文件并生成图形报告

```bash
v-update-sys-rrd-ftp daily
```

执行此命令后，脚本将收集 FTP 服务的每日连接数数据，并更新到对应的 RRD 文件中。同时，生成一个名为 `daily-ftp.png` 的 PNG 图像文件，用于展示每日的连接数变化趋势。

#### 示例 2：每周更新 FTP 的 RRD 文件并生成图形报告

```bash
v-update-sys-rrd-ftp weekly
```

与示例 1 类似，此命令将收集 FTP 服务的每周连接数数据，并更新到 RRD 文件中。生成的图形报告将展示每周的连接数变化趋势。

### 注意事项

- 在运行此脚本之前，请确保已经正确配置了 Hestia 控制面板，并且 FTP 服务正在运行。
- 根据系统的负载和性能需求，管理员可能需要调整 RRD 文件的更新频率和阈值。
- 该脚本可能需要一些时间来执行，特别是当需要生成图形报告时。请确保在执行此脚本时，系统具有足够的资源可用。

### 总结

`v-update-sys-rrd-ftp` 脚本是 Hestia 控制面板中用于监控和分析 FTP 服务性能的重要工具。通过定期更新 RRD 文件并生成图形报告，管理员可以轻松地了解 FTP 服务的连接数变化趋势，以便及时发现问题并进行优化。在使用此脚本时，请遵循最佳实践，并根据需要进行适当的调整和监控。

## v-update-sys-rrd-httpd

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-httpd)

本文档将详细解释Hestia控制面板中的CLI命令脚本`v-update-sys-rrd-httpd`的功能、用法和示例。

### 功能描述

`v-update-sys-rrd-httpd`脚本用于更新Hestia控制面板中用于监控HTTPD服务器性能的RRD数据库。该脚本能够根据指定的时间段（daily、weekly、monthly或yearly）收集HTTPD服务器的连接数数据，并将其存储在RRD数据库中。同时，脚本还能够生成对应时间段的HTTPD服务器连接数图表，用于性能分析和监控。

### 用法说明

#### 参数说明

- `period`：指定时间段，可选值为daily、weekly、monthly或yearly。默认为daily。

#### 示例用法

1. 更新daily时间段的HTTPD服务器连接数数据并生成图表：
```bash
v-update-sys-rrd-httpd daily
```

2. 更新weekly时间段的HTTPD服务器连接数数据并生成图表：
```bash
v-update-sys-rrd-httpd weekly
```

3. 更新monthly时间段的HTTPD服务器连接数数据并生成图表：
```bash
v-update-sys-rrd-httpd monthly
```

4. 更新yearly时间段的HTTPD服务器连接数数据并生成图表：
```bash
v-update-sys-rrd-httpd yearly
```

### 脚本执行流程

1. **参数处理**：脚本首先处理传入的参数`period`，根据参数值设置不同的时间范围和网格格式。

2. **目录和文件检查**：检查RRD数据库存储目录`$RRD/web`是否存在，如果不存在则创建该目录。检查RRD数据文件`httpd.rrd`是否存在，如果不存在则使用`rrdtool create`命令创建该文件，并定义数据源（DS）和归档规则（RRA）。

3. **数据收集**：根据指定的时间段，通过`wget`命令从HTTPD服务器的状态页面获取当前正在处理的请求数（active和idle），并计算总连接数（a）。然后使用`rrdtool update`命令将收集到的数据更新到RRD数据库中。

4. **图表生成**：使用`rrdtool graph`命令生成对应时间段的HTTPD服务器连接数图表。图表中包含了连接数的平均值、最小值、最大值等统计信息，并通过颜色、字体等样式设置进行美化。生成的图表文件保存在`$RRD/web`目录下，文件名以时间段命名（如`daily-httpd.png`）。

### 注意事项

- 确保脚本具有执行权限，可以使用`chmod +x v-update-sys-rrd-httpd`命令添加执行权限。
- 脚本中使用的RRD数据库路径、函数库路径等需要根据实际的Hestia安装路径进行配置。
- 脚本中的HTTPD服务器状态页面URL（`http://localhost:8081/server-status`）需要根据实际的HTTPD服务器配置进行更改。
- 脚本执行过程中可能会遇到网络问题、权限问题等，需要根据具体的错误信息进行排查和解决。

### 总结

`v-update-sys-rrd-httpd`脚本是Hestia控制面板中用于监控HTTPD服务器性能的重要工具之一。通过该脚本，管理员可以方便地收集HTTPD服务器的连接数数据，并将其以图表的形式展示出来，从而实现对HTTPD服务器性能的实时监控和分析。通过灵活设置时间段和样式，管理员可以根据实际需求生成不同时间段和风格的图表，满足不同的监控需求。

## v-update-sys-rrd-la

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-la)

本文档将详细解释Hestia控制面板中的CLI命令脚本`v-update-sys-rrd-la`的功能、用法和示例。该脚本主要用于更新系统负载平均数的RRD数据库，并提供相关的监控和日志记录功能。

### 功能描述

`v-update-sys-rrd-la`脚本负责收集系统负载平均数（Load Average）数据，并将其更新到RRD数据库中。负载平均数是一个反映系统负载情况的指标，包括1分钟、5分钟和15分钟的平均值。通过该脚本，管理员可以实时监控系统的负载情况，并进行性能分析和故障排除。

### 用法说明

#### 参数说明

- `SERVICE`：指定要监控的服务名称。该参数是必需的，用于指定要收集负载数据的特定服务或系统整体。

#### 示例用法

1. 更新系统整体的负载平均数数据：
```bash
v-update-sys-rrd-la
```

2. 更新特定服务（如MySQL）的负载平均数数据：
```bash
v-update-sys-rrd-la mysql
```

### 脚本执行流程

1. **参数处理**：脚本首先检查传入的参数数量和格式是否有效，确保提供了正确的服务名称。

2. **包含文件和配置加载**：脚本包含必要的配置文件和函数库，以便使用Hestia控制面板的相关功能和变量。

3. **服务处理**：根据传入的服务名称，脚本进行不同的处理。如果服务名称为`php-fpm`，则遍历多个PHP版本，为每个版本构建服务列表；否则，直接使用传入的服务名称作为服务列表。

4. **服务启动**：对于服务列表中的每个服务，脚本尝试启动该服务。如果服务名为`iptables`，则调用`v-update-firewall`脚本更新防火墙配置；否则，使用`systemctl start`命令启动服务。

5. **结果检查与日志记录**：启动服务后，脚本检查命令的返回值，如果启动失败，则记录错误日志；如果启动成功，则记录信息日志。同时，使用`check_result`函数对结果进行进一步的检查，并在失败时输出错误信息并退出脚本。

6. **日志事件记录**：无论服务启动是否成功，脚本都会记录一个日志事件，以标记该操作的完成状态。

### 注意事项

- 确保脚本具有执行权限，可以使用`chmod +x v-update-sys-rrd-la`命令添加执行权限。
- 脚本中的配置文件路径、函数库路径等需要根据实际的Hestia安装路径进行配置。
- 脚本中使用的系统命令（如`systemctl start`）需要确保在系统中有相应的权限和配置。
- 脚本中的日志记录和事件记录功能依赖于Hestia控制面板的日志系统，确保该系统已正确配置并可用。

### 总结

`v-update-sys-rrd-la`脚本是Hestia控制面板中用于监控系统负载平均数的重要工具。通过该脚本，管理员可以方便地收集负载数据，并将其存储在RRD数据库中，以便进行后续的性能分析和监控。脚本支持针对特定服务或系统整体的负载数据收集，提供了灵活的使用方式。同时，脚本还具备日志记录和错误处理功能，确保操作的可靠性和可追踪性。

## v-update-sys-rrd-mail

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-mail)

### 功能描述

`v-update-sys-rrd-mail`脚本用于更新邮件队列大小的RRD（Round Robin Database）数据，并根据指定的时间段绘制图形化展示。该脚本可以帮助管理员监控邮件服务器的队列大小，以便及时发现潜在的邮件发送问题或性能瓶颈。

### 参数说明

- `period`：指定要更新的时间段，可选值为`daily`（每日）、`weekly`（每周）、`monthly`（每月）和`yearly`（每年）。如果不提供参数，则默认为`daily`。

### 使用示例

1. **更新每日邮件队列数据并生成图形**

   ```bash
   v-update-sys-rrd-mail daily
   ```

   此命令将更新过去24小时的邮件队列数据，并生成一个名为`daily-mail.png`的图形文件，展示队列大小的变化情况。

2. **更新每周邮件队列数据并生成图形**

   ```bash
   v-update-sys-rrd-mail weekly
   ```

   此命令将更新过去一周的邮件队列数据，并生成一个相应的图形文件。

3. **更新每月邮件队列数据并生成图形**

   ```bash
   v-update-sys-rrd-mail monthly
   ```

   此命令将更新过去一个月的邮件队列数据，并生成一个相应的图形文件。

4. **更新每年邮件队列数据并生成图形**

   ```bash
   v-update-sys-rrd-mail yearly
   ```

   此命令将更新过去一年的邮件队列数据，并生成一个相应的图形文件。

### 脚本执行流程

1. **参数处理**：脚本首先检查传入的`period`参数，根据参数值设置不同的时间段和网格配置。

2. **环境准备**：脚本加载Hestia的配置文件、函数库和配置信息。

3. **创建RRD目录和文件**：检查RRD数据存储目录是否存在，如果不存在则创建。然后检查RRD数据文件是否存在，如果不存在则使用`rrdtool create`命令创建新的RRD文件。

4. **更新RRD数据**：根据指定的时间段，使用`exim -bpc`命令获取当前的邮件队列大小，并使用`rrdtool update`命令将数据更新到RRD文件中。

5. **绘制图形**：使用`rrdtool graph`命令根据RRD数据绘制图形，并指定图形的格式、尺寸、颜色等属性。生成的图形文件保存在RRD数据存储目录下，文件名包含时间段信息。

6. **结果检查**：检查`rrdtool graph`命令的返回值，如果非零则表示出错，脚本将退出并返回错误码。

### 注意事项

- 确保脚本具有执行权限，可以使用`chmod +x v-update-sys-rrd-mail`命令添加执行权限。
- 脚本中的配置文件路径、函数库路径和RRD数据存储目录需要根据实际的Hestia安装路径进行配置。
- 脚本中使用的`exim -bpc`命令依赖于Exim邮件服务器，确保该服务已正确安装并配置。
- 脚本中的RRD工具和图形绘制命令需要预先安装RRDtool软件包，并确保相关命令可用。

### 总结

`v-update-sys-rrd-mail`脚本是Hestia控制面板中用于监控邮件队列大小的重要工具。通过该脚本，管理员可以方便地更新RRD数据并生成图形化展示，以便直观地了解邮件队列的变化情况。脚本支持不同的时间段选项，提供了灵活的使用方式。同时，脚本还包含错误处理和结果检查功能，确保操作的可靠性和准确性。

## v-update-sys-rrd-mem

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-mem)

### 功能描述

`v-update-sys-rrd-mem`脚本用于更新系统内存使用情况的RRD（Round Robin Database）数据，并根据指定的时间段绘制图形化展示。该脚本可以帮助管理员监控服务器的内存使用情况，包括RAM、SWAP和可用内存，以便及时发现潜在的内存问题或性能瓶颈。

### 参数说明

- `period`：指定要更新的时间段，可选值为`daily`（每日）、`weekly`（每周）、`monthly`（每月）和`yearly`（每年）。如果不提供参数，则默认为`daily`。

### 使用示例

1. **更新每日内存使用情况数据并生成图形**

   ```bash
   v-update-sys-rrd-mem daily
   ```

   此命令将更新过去24小时的内存使用情况数据，并生成一个名为`daily-mem.png`的图形文件，展示内存使用的变化情况。

2. **更新每周内存使用情况数据并生成图形**

   ```bash
   v-update-sys-rrd-mem weekly
   ```

   此命令将更新过去一周的内存使用情况数据，并生成一个相应的图形文件。

3. **更新每月内存使用情况数据并生成图形**

   ```bash
   v-update-sys-rrd-mem monthly
   ```

   此命令将更新过去一个月的内存使用情况数据，并生成一个相应的图形文件。

4. **更新每年内存使用情况数据并生成图形**

   ```bash
   v-update-sys-rrd-mem yearly
   ```

   此命令将更新过去一年的内存使用情况数据，并生成一个相应的图形文件。

### 脚本执行流程

1. **参数处理**：脚本首先检查传入的`period`参数，根据参数值设置不同的时间段和网格配置。

2. **环境准备**：脚本加载Hestia的配置文件、函数库和配置信息。

3. **创建RRD目录**：检查RRD数据存储目录是否存在，如果不存在则创建。

4. **检查RRD文件**：检查RRD数据文件是否存在，如果不存在则创建新的RRD文件；如果文件存在但缺少必要的DS（数据源），则删除该文件并重新创建。

5. **获取内存数据**：使用`free -m`命令获取系统的内存使用情况，包括已用内存、SWAP使用情况和可用内存。

6. **更新RRD数据**：将获取的内存数据更新到RRD文件中。

7. **绘制图形**：使用`rrdtool graph`命令根据RRD数据绘制图形，并指定图形的格式、尺寸、颜色等属性。生成的图形文件保存在RRD数据存储目录下，文件名包含时间段信息。

### 注意事项

- 确保脚本具有执行权限，可以使用`chmod +x v-update-sys-rrd-mem`命令添加执行权限。
- 脚本中的配置文件路径、函数库路径和RRD数据存储目录需要根据实际的Hestia安装路径进行配置。
- 脚本中使用的`free -m`命令用于获取内存使用情况，确保该命令在服务器上可用。
- 脚本中的RRD工具和图形绘制命令需要预先安装RRDtool软件包，并确保相关命令可用。

### 总结

`v-update-sys-rrd-mem`脚本是Hestia控制面板中用于监控内存使用情况的重要工具。通过该脚本，管理员可以方便地更新RRD数据并生成图形化展示，以便直观地了解内存使用的变化情况。脚本支持不同的时间段选项，提供了灵活的使用方式。同时，脚本还包含错误处理和结果检查功能，确保操作的可靠性和准确性。

## v-update-sys-rrd-mysql

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-mysql)

### 功能描述

`v-update-sys-rrd-mysql` 是一个CLI（命令行界面）脚本，用于更新Hestia控制面板系统中MySQL数据库的状态信息至RRD（Round Robin Database）。该脚本能够收集MySQL的查询次数和慢查询次数，并将这些数据存储在RRD文件中，同时生成图形化展示，以便管理员能够直观地监控和分析MySQL的性能。

### 脚本参数

- `period`：指定数据更新的时间范围，可以是`daily`（每日）、`weekly`（每周）、`monthly`（每月）或`yearly`（每年）。如未指定，则默认为`daily`。

### 使用示例

1. **每日更新MySQL状态数据**

   ```bash
   v-update-sys-rrd-mysql daily
   ```

   执行此命令将更新MySQL在过去24小时内的状态数据，并生成相应的图形。

2. **每周更新MySQL状态数据**

   ```bash
   v-update-sys-rrd-mysql weekly
   ```

   执行此命令将更新MySQL在过去一周的状态数据，并生成相应的图形。

### 脚本执行流程

1. **参数处理**：根据传入的`period`参数，设置不同的时间范围和图形网格配置。

2. **环境初始化**：加载Hestia的配置文件、函数库和数据库配置信息。

3. **创建RRD目录**：如果RRD数据目录不存在，则创建该目录。

4. **读取MySQL配置**：从配置文件中读取MySQL主机的信息。

5. **处理排除项**：根据配置排除指定的MySQL主机。

6. **处理每个MySQL主机**：
   - 检查并创建RRD文件（如果不存在）。
   - 根据`period`参数决定是否连接到MySQL服务器并获取状态信息。
   - 更新RRD文件中的数据。
   - 生成图形文件，并设置图形的各种属性，如颜色、字体、标题等。

7. **错误检查**：检查`rrdtool graph`命令的执行结果，如果出错则退出脚本。

### 脚本细节与注意事项

- **颜色配置**：脚本中使用`-c`选项为图形设置了多种颜色，包括背景色、网格线颜色、字体颜色等，以便生成清晰易读的图形。

- **图形元素**：脚本使用`DEF`定义RRD数据集中的变量，`LINE`和`AREA`绘制图形中的线和区域，`GPRINT`用于在图形下方显示最后、最小和最大的数值。

- **错误处理**：脚本在生成图形后检查`rrdtool`命令的返回值，如果非零则退出脚本，并返回错误码`$E_RRD`。

- **依赖项**：脚本依赖于`rrdtool`命令，因此在运行脚本之前需要确保已经安装了RRDtool软件包。

- **配置路径**：脚本中使用的配置文件路径、函数库路径等需要根据实际的Hestia安装路径进行配置。

### 总结

`v-update-sys-rrd-mysql` 脚本是Hestia控制面板中用于监控MySQL性能的重要工具。它能够帮助管理员收集和可视化MySQL的查询和慢查询数据，从而及时发现性能问题并进行优化。脚本支持不同的时间范围选项，并提供灵活的图形配置选项，使得生成的图形既美观又实用。

## v-update-sys-rrd-net

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-net)

### 功能描述

`v-update-sys-rrd-net` 是Hestia控制面板中的一个CLI（命令行界面）脚本，用于监控网络接口的流量数据，并将这些数据保存在RRD（Round Robin Database）文件中。同时，该脚本能够生成对应的网络流量图形，以便管理员直观地了解网络接口的流量情况。

### 脚本参数

- `period`：指定数据更新的时间范围，可以是`daily`（每日）、`weekly`（每周）、`monthly`（每月）或`yearly`（每年）。如未指定，则默认为`daily`。

### 使用示例

1. **每日更新网络接口流量数据**

   ```bash
   v-update-sys-rrd-net daily
   ```

   执行此命令将更新过去24小时内网络接口的流量数据，并生成相应的图形。

2. **每周更新网络接口流量数据**

   ```bash
   v-update-sys-rrd-net weekly
   ```

   执行此命令将更新过去一周内网络接口的流量数据，并生成相应的图形。

### 脚本执行流程

1. **参数处理**：根据传入的`period`参数，设置不同的时间范围和网格配置。

2. **环境初始化**：加载Hestia的配置文件、函数库和网络配置信息。

3. **创建RRD目录**：如果RRD数据目录不存在，则创建该目录。

4. **读取网络接口数据**：从`/proc/net/dev`文件中读取所有网络接口的数据。

5. **排除特定接口**：根据配置排除指定的网络接口，如本地回环接口`lo`、Docker虚拟网络接口等。

6. **处理每个网络接口**：
   - 检查并创建对应的RRD文件（如果不存在）。
   - 根据`period`参数决定是否更新RRD文件中的流量数据。
   - 生成网络接口流量图形，并设置图形的各种属性，如颜色、字体、标题等。

7. **错误检查**：检查`rrdtool graph`命令的执行结果，如果出错则退出脚本。

### 脚本细节与注意事项

- **颜色配置**：脚本使用`-c`选项为图形设置了多种颜色，包括背景色、网格线颜色、字体颜色等，以生成清晰易读的图形。

- **RRD文件结构**：RRD文件包含两个数据源（DS），分别表示接收（RX）和发送（TX）的流量数据，并且设置了多个RRA（Round Robin Archive）用于存储不同时间粒度的数据。

- **图形元素**：脚本使用`rrdtool graph`命令生成网络流量图形，通过`DEF`定义RRD数据集中的变量，并使用各种绘图选项来定制图形的外观。

- **错误处理**：脚本在生成图形后检查`rrdtool`命令的返回值，如果非零则退出脚本，并返回错误码。

- **依赖项**：脚本依赖于`rrdtool`命令，因此在运行脚本之前需要确保已经安装了RRDtool软件包。

- **配置路径**：脚本中使用的配置文件路径、函数库路径等需要根据实际的Hestia安装路径进行配置。

### 总结

`v-update-sys-rrd-net` 脚本是Hestia控制面板中用于监控网络接口流量的重要工具。它能够帮助管理员实时跟踪网络接口的流量情况，并通过图形化展示提供更加直观的数据分析。脚本支持不同的时间范围选项，并提供了灵活的图形配置选项，使得生成的图形既美观又实用。

## v-update-sys-rrd-nginx

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-nginx)

### 功能描述

`v-update-sys-rrd-nginx` 是Hestia控制面板中的一个CLI（命令行界面）脚本，用于监控Nginx服务器的连接数，并将数据保存在RRD（Round Robin Database）文件中。同时，该脚本能够生成对应的Nginx连接数图形，以便管理员直观地了解Nginx服务器的负载情况。

### 脚本参数

- `period`：指定数据更新的时间范围，可以是`daily`（每日）、`weekly`（每周）、`monthly`（每月）或`yearly`（每年）。如未指定，则默认为`daily`。

### 使用示例

1. **每日更新Nginx连接数数据**

   ```bash
   v-update-sys-rrd-nginx daily
   ```

   执行此命令将更新过去24小时内Nginx的连接数数据，并生成相应的图形。

2. **每周更新Nginx连接数数据**

   ```bash
   v-update-sys-rrd-nginx weekly
   ```

   执行此命令将更新过去一周内Nginx的连接数数据，并生成相应的图形。

### 脚本执行流程

1. **参数处理**：根据传入的`period`参数，设置不同的时间范围和网格配置。

2. **环境初始化**：加载Hestia的配置文件、函数库和网络配置信息。

3. **创建RRD目录**：如果RRD数据目录不存在，则创建该目录。

4. **创建或更新RRD文件**：
   - 检查Nginx连接数的RRD文件是否存在，如果不存在则创建。
   - 根据`period`参数决定是否更新RRD文件中的连接数数据。

5. **生成Nginx连接数图形**：
   - 使用`rrdtool graph`命令生成Nginx连接数图形。
   - 设置图形的各种属性，如颜色、字体、标题等。
   - 在图形上显示Nginx连接数的当前值、最小值、最大值等信息。

6. **错误检查**：检查`rrdtool graph`命令的执行结果，如果出错则退出脚本。

### 脚本细节与注意事项

- **数据源类型**：Nginx连接数数据使用`GAUGE`类型的数据源（DS），表示可以任意变化的数值。

- **RRD文件结构**：RRD文件包含一个数据源（DS）和多个RRA（Round Robin Archive），用于存储不同时间粒度的数据。

- **图形元素**：脚本使用`rrdtool graph`命令生成Nginx连接数图形，并使用`DEF`定义RRD数据集中的变量，使用`LINE1`绘制线条，使用`GPRINT`打印数据。

- **颜色配置**：脚本使用`-c`选项为图形设置了多种颜色，包括背景色、网格线颜色、字体颜色等，以生成清晰易读的图形。

- **错误处理**：脚本在生成图形后检查`rrdtool`命令的返回值，如果非零则退出脚本，并返回错误码。

- **依赖项**：脚本依赖于`rrdtool`命令和`wget`命令，因此在运行脚本之前需要确保已经安装了这些软件包。

- **配置路径**：脚本中使用的配置文件路径、函数库路径等需要根据实际的Hestia安装路径进行配置。

### 总结

`v-update-sys-rrd-nginx` 脚本是Hestia控制面板中用于监控Nginx服务器连接数的重要工具。它能够帮助管理员实时跟踪Nginx服务器的负载情况，并通过图形化展示提供更加直观的数据分析。脚本支持不同的时间范围选项，并提供了灵活的图形配置选项，使得生成的图形既美观又实用。

## v-update-sys-rrd-pgsql

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-pgsql)

### 功能描述

`v-update-sys-rrd-pgsql` 是Hestia控制面板中的一个CLI（命令行界面）脚本，用于监控PostgreSQL数据库的活动和性能数据，并将这些数据保存在RRD（Round Robin Database）文件中。同时，该脚本能够生成对应的图形，以便管理员直观地分析数据库服务器的运行状况。

### 脚本参数

- `period`：指定数据更新的时间范围，可以是`daily`（每日）、`weekly`（每周）、`monthly`（每月）或`yearly`（每年）。如未指定，则默认为`daily`。

### 使用示例

1. **每日更新PostgreSQL数据库活动数据**

   ```bash
   v-update-sys-rrd-pgsql daily
   ```

   执行此命令将更新过去24小时内PostgreSQL数据库的活动数据，并生成相应的图形。

2. **每周更新PostgreSQL数据库性能数据**

   ```bash
   v-update-sys-rrd-pgsql weekly
   ```

   执行此命令将更新过去一周内PostgreSQL数据库的性能数据，并生成相应的图形。

### 脚本执行流程

1. **参数处理**：根据传入的`period`参数，设置不同的时间范围和网格配置。

2. **环境初始化**：加载Hestia的配置文件、函数库和网络配置信息。

3. **创建RRD目录**：如果RRD数据目录不存在，则创建该目录。

4. **读取PostgreSQL配置**：从`pgsql.conf`配置文件中读取PostgreSQL数据库的主机信息。

5. **过滤排除的主机**：根据`RRD_PGSQL_EXCLUDE`环境变量中指定的主机列表，从读取到的主机列表中排除这些主机。

6. **处理每个数据库主机**：对于每个PostgreSQL数据库主机，执行以下操作：
   - 检查RRD文件是否存在，如果不存在则创建。
   - 提取数据库连接信息（主机、用户名、密码）。
   - 使用`psql`命令执行SQL查询，获取数据库的活动和性能数据。
   - 更新RRD文件中的数据库数据。

7. **生成PostgreSQL数据库图形**：
   - 脚本生成包含数据库活动和性能数据的图形，具体的图形元素和样式配置可以进一步扩展。

8. **错误检查**：检查脚本执行过程中是否出现错误，并根据错误情况返回相应的退出码。

### 脚本细节与注意事项

- **数据源类型**：PostgreSQL数据库的活动和性能数据使用`GAUGE`和`COUNTER`类型的数据源（DS），分别表示可以任意变化的数值和累计增长的计数器。

- **RRD文件结构**：RRD文件包含一个或多个数据源（DS）和多个RRA（Round Robin Archive），用于存储不同时间粒度的数据。

- **图形元素**：脚本使用`rrdtool`命令生成图形，可以使用`DEF`定义RRD数据集中的变量，使用绘图函数（如`LINE`、`AREA`等）绘制图形元素。

- **颜色配置**：脚本可以配置图形的颜色、字体、网格线等样式，以生成清晰易读的图形。

- **错误处理**：脚本在读取配置文件、执行SQL查询、更新RRD文件等关键步骤时，都会进行错误检查，并根据错误情况返回相应的退出码。

- **依赖项**：脚本依赖于`rrdtool`命令和`psql`命令，因此在运行脚本之前需要确保已经安装了这些软件包，并且`psql`命令能够在脚本的执行环境中找到。

- **安全性**：在脚本中处理数据库连接信息时，需要注意安全性问题，避免将敏感信息（如密码）明文存储在脚本中或暴露给未经授权的用户。

### 总结

`v-update-sys-rrd-pgsql` 脚本是Hestia控制面板中用于监控PostgreSQL数据库的重要工具。它能够帮助管理员实时跟踪数据库的活动和性能数据，并通过图形化展示提供更加直观的数据分析。脚本支持不同的时间范围选项，并提供了灵活的图形配置选项，使得生成的图形既美观又实用。同时，脚本也考虑了安全性和错误处理等方面的问题，以确保脚本的稳定性和可靠性。

## v-update-sys-rrd-ssh

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-ssh)

### 功能描述

`v-update-sys-rrd-ssh` 是Hestia控制面板中的一个CLI（命令行界面）脚本，用于监控SSH服务的连接情况，并将这些数据保存在RRD（Round Robin Database）文件中。同时，该脚本能够生成对应的图形，以便管理员直观地分析SSH服务的连接状态。

### 脚本参数

- `period`：指定数据更新的时间范围，可以是`daily`（每日）、`weekly`（每周）、`monthly`（每月）或`yearly`（每年）。如未指定，则默认为`daily`。

### 使用示例

1. **每日更新SSH连接数据**

   ```bash
   v-update-sys-rrd-ssh daily
   ```

   执行此命令将更新过去24小时内SSH服务的连接数据，并生成相应的图形。

2. **每周更新SSH连接数据**

   ```bash
   v-update-sys-rrd-ssh weekly
   ```

   执行此命令将更新过去一周内SSH服务的连接数据，并生成相应的图形。

### 脚本执行流程

1. **参数处理**：根据传入的`period`参数，设置不同的时间范围和网格配置。

2. **环境初始化**：加载Hestia的配置文件、函数库和网络配置信息。

3. **创建RRD目录**：如果SSH服务的RRD数据目录不存在，则创建该目录。

4. **创建或更新RRD文件**：如果SSH服务的RRD文件不存在，则创建该文件，并设置数据源（DS）和Round Robin Archive（RRA）的配置。

5. **获取SSH连接数**：使用`ps`命令查询SSH服务的活动连接数，并更新到RRD文件中。

6. **生成SSH连接图形**：使用`rrdtool`命令生成包含SSH连接数据的图形，并设置图形的颜色、大小、网格线等样式。

7. **错误检查**：检查图形生成过程中是否出现错误，并根据错误情况返回相应的退出码。

### 脚本细节与注意事项

- **数据源类型**：SSH连接数使用`GAUGE`类型的数据源（DS），表示可以任意变化的数值。

- **RRD文件结构**：RRD文件包含一个数据源（DS）和多个RRA（Round Robin Archive），用于存储不同时间粒度的数据。

- **图形元素**：脚本使用`rrdtool`命令生成图形，可以使用`DEF`定义RRD数据集中的变量，使用绘图函数（如`LINE`）绘制图形元素。

- **颜色配置**：脚本可以配置图形的颜色、字体、网格线等样式，以生成清晰易读的图形。

- **错误处理**：脚本在查询SSH连接数、更新RRD文件、生成图形等关键步骤时，都会进行错误检查，并根据错误情况返回相应的退出码。

- **依赖项**：脚本依赖于`rrdtool`命令，因此在运行脚本之前需要确保已经安装了该软件包，并且`rrdtool`命令能够在脚本的执行环境中找到。

- **安全性**：脚本在查询SSH连接数时，通过`grep`命令过滤掉不相关的进程，避免统计错误。然而，对于更高级别的安全性需求，可能需要进一步加固脚本或采用其他监控方法。

### 总结

`v-update-sys-rrd-ssh` 脚本是Hestia控制面板中用于监控SSH服务的重要工具。它能够帮助管理员实时跟踪SSH服务的连接情况，并通过图形化展示提供更加直观的数据分析。脚本支持不同的时间范围选项，并提供了灵活的图形配置选项，使得生成的图形既美观又实用。同时，脚本也考虑了错误处理等方面的问题，以确保脚本的稳定性和可靠性。

## v-list-sys-rrd

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-list-sys-rrd)

#### 一、概述

`v-list-sys-rrd` 是 Hestia 控制面板的一个命令行工具，用于列出系统中不同类型的 RRD (Round Robin Database) 文件信息。RRD 文件通常用于存储时间序列数据，如系统性能监控数据。该工具支持多种输出格式，包括 JSON、Plain、CSV 和 Shell 格式，以满足不同用户的需求。

#### 二、使用说明

**语法：**
```bash
v-list-sys-rrd [FORMAT]
```

**参数：**
- `FORMAT`：指定输出格式。可选值包括 `json`、`plain`、`csv` 和 `shell`。如果未指定格式，默认为 `shell` 格式。

**示例：**
1. 以 Shell 格式列出 RRD 文件信息：
```bash
v-list-sys-rrd shell
```

2. 以 CSV 格式列出 RRD 文件路径：
```bash
v-list-sys-rrd csv
```

#### 三、功能描述

1. **JSON 格式输出**：以 JSON 结构展示 RRD 文件信息，包括类型、文件名、标题、时间戳和日期等详细信息。

2. **Shell 格式输出**：以表格形式展示 RRD 文件信息，包括类型、值1、值2、值3、时间和日期。如果某个值不存在，则显示为 `-nan`。

3. **Plain 格式输出**：仅列出 RRD 文件的完整路径，每行一个文件路径。

4. **CSV 格式输出**：以 CSV 格式展示 RRD 文件路径，适用于导入到其他软件或进行数据分析。

#### 四、输出字段说明

- **TYPE**：RRD 文件的类型，如 `la`、`mem`、`net` 等。
- **VAL_1, VAL_2, VAL_3**：RRD 文件中的值，具体含义取决于 RRD 文件的配置和用途。
- **TIME**：RRD 文件中的数据时间戳。
- **DATE**：RRD 文件中的数据日期。

#### 五、环境变量

该脚本可以根据以下环境变量来确定需要列出的 RRD 文件类型：
- `WEB_SYSTEM`：如果设置，将包含 web 类型的 RRD 文件。
- `MAIL_SYSTEM`：如果设置，将包含 mail 类型的 RRD 文件。
- `DB_SYSTEM`：如果设置，将包含 db 类型的 RRD 文件。
- `FTP_SYSTEM`：如果设置，将包含 ftp 类型的 RRD 文件。

此外，脚本默认包含 `la`、`mem` 和 `net` 类型的 RRD 文件。

#### 六、注意事项

1. **权限要求**：执行该脚本需要具有足够的权限来访问 RRD 文件所在的目录，并读取 RRD 文件内容。

2. **依赖关系**：该脚本依赖于 `rrdtool` 命令来提取 RRD 文件中的数据。请确保 `rrdtool` 已在系统上正确安装并配置。

3. **错误处理**：脚本包含基本的错误处理逻辑，但用户仍应关注脚本的执行结果，确保没有错误发生，并正确列出所有 RRD 文件信息。

#### 七、支持与反馈

如果您在使用 `v-list-sys-rrd` 脚本时遇到任何问题或需要进一步的帮助，请查阅 Hestia 控制面板的官方文档或联系技术支持团队。

#### 八、总结

`v-list-sys-rrd` 是一个功能强大且灵活的命令行工具，用于列出 Hestia 控制面板系统中的 RRD 文件信息。通过选择适当的输出格式，用户可以方便地获取所需的 RRD 文件数据，并进行进一步的分析和处理。

## v-export-rrd

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-export-rrd)

将 rrd 图表导出为 json

**选项**: `[CHART]` `[TIMESPAN]`

**示例**:

```bash
v-export-rrd chart format
```

## v-update-sys-rrd-nginx

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-nginx)

### 概述

`v-update-sys-rrd-nginx` 脚本用于根据指定的时间周期（daily, weekly, monthly, yearly）更新 Nginx 的 RRD (Round Robin Database) 监控数据，并生成对应的 PNG 图像文件来展示 Nginx 连接数的统计信息。

### 使用方法

```bash
v-update-sys-rrd-nginx [period]
```

其中 `[period]` 可以是 `daily`、`weekly`、`monthly` 或 `yearly`，用于指定要更新的时间周期。如果不指定时间周期，则默认为 `daily`。

### 示例

#### 示例 1: 每日更新

```bash
v-update-sys-rrd-nginx daily
```

该命令会更新过去一天的 Nginx 连接数统计信息，并生成名为 `daily-nginx.png` 的图像文件。

#### 示例 2: 每周更新

```bash
v-update-sys-rrd-nginx weekly
```

该命令会更新过去一周的 Nginx 连接数统计信息，并生成名为 `weekly-nginx.png` 的图像文件。

#### 示例 3: 每月更新

```bash
v-update-sys-rrd-nginx monthly
```

该命令会更新过去一个月的 Nginx 连接数统计信息，并生成名为 `monthly-nginx.png` 的图像文件。

#### 示例 4: 每年更新

```bash
v-update-sys-rrd-nginx yearly
```

该命令会更新过去一年的 Nginx 连接数统计信息，并生成名为 `yearly-nginx.png` 的图像文件。

### 脚本流程

1. **参数处理**：脚本首先检查是否传递了时间周期参数，并根据参数值设置不同的时间范围和图表网格。

2. **配置文件加载**：加载 Hestia Control Panel 的配置文件，并获取相关的配置信息。

3. **创建或更新 RRD 数据库**：如果 Nginx 的 RRD 数据库文件不存在，则创建它；否则，直接使用现有的数据库文件。

4. **更新 RRD 数据库**：根据时间周期，从 Nginx 状态页面获取连接数信息，并更新到 RRD 数据库中。

5. **生成图表**：使用 `rrdtool` 工具从 RRD 数据库中提取数据，并生成 PNG 图像文件。

6. **错误处理**：如果图表生成过程中发生错误，则脚本会记录错误信息并退出。

### 注意事项

- 确保 Hestia Control Panel 的 Nginx 服务正在运行，并且可以从 `http://localhost:8084/` 访问到 Nginx 状态页面。
- 脚本中的 `RRD_STEP` 变量在示例中未明确给出，它通常在 Hestia 的配置文件中定义，表示 RRD 数据库的数据更新步长。
- 脚本中使用的 RRD 数据库和图表文件路径（如 `$RRD/web/nginx.rrd` 和 `$RRD/web/$period-nginx.png`）需要确保目录存在且具有适当的写入权限。

### 结论

`v-update-sys-rrd-nginx` 脚本为 Hestia Control Panel 提供了一个方便的工具，用于根据指定的时间周期更新 Nginx 的 RRD 监控数据，并生成直观的图表文件。通过运行该脚本，管理员可以轻松地监控和分析 Nginx 的连接数统计信息。

## v-update-sys-rrd-ssh

* [命令行Bash 脚本查看](https://hestiamb.org/bin/v-update-sys-rrd-ssh)

### 命令概述

`v-update-sys-rrd-ssh` 是 Hestia 控制面板中的一个 CLI 命令，用于更新 SSH 相关的 RRD 数据库和图形。此命令允许系统管理员根据指定的时间周期（如日、周、月、年）来更新 SSH 活动记录。

### 语法

```bash
v-update-sys-rrd-ssh [PERIOD]
```

- `PERIOD`：可选参数，指定更新周期。默认为 "daily"。其他可选值包括 "weekly", "monthly", "yearly"。

### 示例

1. **更新日 SSH 活动记录**

```bash
v-update-sys-rrd-ssh daily
```

这个命令将更新过去一天的 SSH 活动记录到 RRD 数据库中，并生成相应的图形。

2. **更新周 SSH 活动记录**

```bash
v-update-sys-rrd-ssh weekly
```

这个命令将更新过去一周的 SSH 活动记录到 RRD 数据库中，并生成相应的图形。

3. **更新月 SSH 活动记录**

```bash
v-update-sys-rrd-ssh monthly
```

这个命令将更新过去一个月的 SSH 活动记录到 RRD 数据库中，并生成相应的图形。

4. **更新年 SSH 活动记录**

```bash
v-update-sys-rrd-ssh yearly
```

这个命令将更新过去一年的 SSH 活动记录到 RRD 数据库中，并生成相应的图形。

### 注意事项

- 运行此命令需要相应的权限。通常，这意味着你需要以 root 用户或具有相应权限的用户身份运行此命令。
- 在运行此命令之前，确保 Hestia 控制面板已正确配置并正在运行。
- 生成的图形和 RRD 数据库文件通常存储在 Hestia 控制面板指定的目录中。你可以通过查看 Hestia 的配置文件或文档来确定这些文件的确切位置。

### 常见问题

- **命令执行失败**：检查你是否具有执行此命令的权限，并确保 Hestia 控制面板正在运行。
- **图形未生成**：检查 RRD 数据库文件是否已成功更新，并查看 Hestia 的日志文件以获取更多信息。
- **时间周期不正确**：确保你指定的时间周期与你的需求相匹配。如果你希望更新特定时间范围内的 SSH 活动记录，你可能需要修改 Hestia 的配置文件或使用其他工具来实现。